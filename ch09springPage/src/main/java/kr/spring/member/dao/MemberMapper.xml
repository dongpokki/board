<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper   
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
<mapper namespace="kr.spring.member.dao.MemberMapper">
	
	<select id="selectList" parameterType="map" resultType="memberVO">
		select * from 
					(select a.*,rownum rnum from
												(select * from spmember m left outer join spmember_detail d on m.mem_num = d.mem_num 
												<where>
													<if test="keyword != '' and keyfield == 1">m.id like '%' || #{keyword} || '%'</if>
													<if test="keyword != '' and keyfield == 2">d.name like '%' || #{keyword} || '%'</if>
													<if test="keyword != '' and keyfield == 3">d.email like '%' || #{keyword} || '%'</if>
												</where>order by d.reg_date desc)a) 
												<![CDATA[where rnum >= #{start} and rnum <= #{end}]]>
	</select>
	
	<select id="selectRowCount" parameterType="map" resultType="integer">
		select count(*) from spmember m left outer join spmember_detail d on m.mem_num=d.mem_num
												<where>
													<if test="keyword != '' and keyfield == 1">m.id like '%' || #{keyword} || '%'</if>
													<if test="keyword != '' and keyfield == 2">d.name like '%' || #{keyword} || '%'</if>
													<if test="keyword != '' and keyfield == 3">d.email like '%' || #{keyword} || '%'</if>
												</where>
	</select>
	
</mapper>